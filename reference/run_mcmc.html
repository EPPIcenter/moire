<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Sample from the target distribution using MCMC"><title>Sample from the target distribution using MCMC — run_mcmc • moire</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sample from the target distribution using MCMC — run_mcmc"><meta property="og:description" content="Sample from the target distribution using MCMC"><meta property="og:image" content="https://EPPIcenter.github.io/moire/reference/figures/moire_web_logo.svg"><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@MxMrphy"><meta name="twitter:site" content="@EPPIcenter_UCSF"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-176090065-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-176090065-1');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">moire</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/mcmc_demo.html">MCMC Demonstration</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/EPPIcenter/moire/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Sample from the target distribution using MCMC</h1>
      <small class="dont-index">Source: <a href="https://github.com/EPPIcenter/moire/blob/HEAD/R/mcmc.R" class="external-link"><code>R/mcmc.R</code></a></small>
      <div class="d-none name"><code>run_mcmc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Sample from the target distribution using MCMC</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run_mcmc</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  is_missing <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  allow_relatedness <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  thin <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  burnin <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  samples_per_chain <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  eps_pos_alpha <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  eps_pos_beta <span class="op">=</span> <span class="fl">9.9</span>,</span>
<span>  eps_neg_alpha <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  eps_neg_beta <span class="op">=</span> <span class="fl">9.9</span>,</span>
<span>  r_alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  r_beta <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  mean_coi_shape <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  mean_coi_scale <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  max_eps_pos <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  max_eps_neg <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  max_coi <span class="op">=</span> <span class="fl">40</span>,</span>
<span>  num_chains <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  num_cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pt_chains <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pt_grad <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pt_num_threads <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  adapt_temp <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  pre_adapt_steps <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  temp_adapt_steps <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>Data to be used in MCMC, as generated by the <code>load_*_data</code> functions</p></dd>


<dt>is_missing</dt>
<dd><p>Boolean matrix indicating whether the observation
should be treated as missing data and ignored. Number of rows equals the
number of loci, number of columns equals the number samples. Alternatively,
the user may pass in FALSE if no data should be considered missing.</p></dd>


<dt>allow_relatedness</dt>
<dd><p>Bool indicating whether or not to allow relatedness
within host</p></dd>


<dt>thin</dt>
<dd><p>Positive Integer. How often to sample from mcmc,
1 means do not thin</p></dd>


<dt>burnin</dt>
<dd><p>Positive Integer. Number of MCMC samples to
discard as burnin</p></dd>


<dt>samples_per_chain</dt>
<dd><p>Positive Integer. Number of samples to take
after burnin</p></dd>


<dt>verbose</dt>
<dd><p>Logical indicating if progress is printed</p></dd>


<dt>eps_pos_alpha</dt>
<dd><p>Positive Numeric. Alpha parameter in
Beta distribution for eps_pos prior</p></dd>


<dt>eps_pos_beta</dt>
<dd><p>Positive Numeric. Beta parameter in
Beta distribution for eps_pos prior</p></dd>


<dt>eps_neg_alpha</dt>
<dd><p>Positive Numeric. Alpha parameter in
Beta distribution for eps_neg prior</p></dd>


<dt>eps_neg_beta</dt>
<dd><p>Positive Numeric. Beta parameter in
Beta distribution for eps_neg prior</p></dd>


<dt>r_alpha</dt>
<dd><p>Positive Numeric. Alpha parameter in Beta
distribution for relatedness prior</p></dd>


<dt>r_beta</dt>
<dd><p>Positive Numeric. Beta parameter in Beta
distribution for relatedness prior</p></dd>


<dt>mean_coi_shape</dt>
<dd><p>shape parameter for gamma hyperprior on mean COI</p></dd>


<dt>mean_coi_scale</dt>
<dd><p>scale parameter for gamma hyperprior on mean COI</p></dd>


<dt>max_eps_pos</dt>
<dd><p>Numeric. Maximum allowed value for eps_pos</p></dd>


<dt>max_eps_neg</dt>
<dd><p>Numeric. Maximum allowed value for eps_neg</p></dd>


<dt>max_coi</dt>
<dd><p>Positive Numeric. Maximum allowed complexity of infection</p></dd>


<dt>num_chains</dt>
<dd><p>Total number of chains to run, possibly simultaneously</p></dd>


<dt>num_cores</dt>
<dd><p>Total OMP parallel threads to use to run chains.
num_cores * pt_num_threads should not exceed the number of cores available
on your system.</p></dd>


<dt>pt_chains</dt>
<dd><p>Total number of chains to run with parallel tempering or a
vector containing the temperatures that should be used for parallel tempering.</p></dd>


<dt>pt_grad</dt>
<dd><p>Power to raise parallel tempering chains to. A value of 1
results in evenly distributed temperatures between [0,1], below 1 will bias
towards 1 and above 1 will bias towards 0. Only used if pt_chains is a
single value (i.e. not a vector).</p></dd>


<dt>pt_num_threads</dt>
<dd><p>Total number of OMP parallel threads to be used to
process parallel tempered chains
num_cores * pt_num_threads should not exceed the number of cores available
on your system.</p></dd>


<dt>adapt_temp</dt>
<dd><p>Logical indicating whether or not to adapt the parallel
tempering temperatures. If TRUE, the temperatures will be adapted during the
<code>burnin</code> period, starting after <code>pre_adapt_steps</code> steps. The adaptation will
occur every <code>temp_adapt_steps</code> steps until burnin is complete. The range of
temperatures will remain the same as specified by <code>pt_chains</code>.</p></dd>


<dt>pre_adapt_steps</dt>
<dd><p>Number of steps to take before starting to adapt the
parallel tempering temperatures. Only used if <code>adapt_temp</code> is TRUE.</p></dd>


<dt>temp_adapt_steps</dt>
<dd><p>Number of steps to take between temperature
adaptation steps. Only used if <code>adapt_temp</code> is TRUE.</p></dd>

</dl></div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Maxwell Murphy, Bryan Greenhouse.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

