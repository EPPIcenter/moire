<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Sample from the target distribution using MCMC — run_mcmc • moire</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Sample from the target distribution using MCMC — run_mcmc" />
<meta property="og:description" content="Sample from the target distribution using MCMC" />
<meta property="og:image" content="https://m-murphy.github.io/moire/reference/figures/logo.png" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:creator" content="@MxMrphy" />
<meta name="twitter:site" content="@EPPIcenter_UCSF" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-176090065-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-176090065-1');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">moire</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mcmc_demo.html">MCMC Demonstration</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/m-murphy/moire/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Sample from the target distribution using MCMC</h1>
    <small class="dont-index">Source: <a href='https://github.com/m-murphy/moire/blob/master/R/mcmc.R'><code>R/mcmc.R</code></a></small>
    <div class="hidden name"><code>run_mcmc.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Sample from the target distribution using MCMC</p>
    </div>

    <pre class="usage"><span class='fu'>run_mcmc</span><span class='op'>(</span>
  <span class='va'>data</span>,
  <span class='va'>sample_ids</span>,
  <span class='va'>loci</span>,
  is_missing <span class='op'>=</span> <span class='cn'>FALSE</span>,
  thin <span class='op'>=</span> <span class='fl'>1</span>,
  burnin <span class='op'>=</span> <span class='fl'>10000</span>,
  samples <span class='op'>=</span> <span class='fl'>10000</span>,
  complexity_limit <span class='op'>=</span> <span class='fl'>2050</span>,
  importance_sampling_depth <span class='op'>=</span> <span class='fl'>300</span>,
  importance_sampling_scaling_factor <span class='op'>=</span> <span class='fl'>100</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  eps_pos_0 <span class='op'>=</span> <span class='fl'>0.01</span>,
  eps_pos_var <span class='op'>=</span> <span class='fl'>0.001</span>,
  eps_pos_alpha <span class='op'>=</span> <span class='fl'>1</span>,
  eps_pos_beta <span class='op'>=</span> <span class='fl'>99</span>,
  eps_neg_0 <span class='op'>=</span> <span class='fl'>0.05</span>,
  eps_neg_var <span class='op'>=</span> <span class='fl'>0.005</span>,
  eps_neg_alpha <span class='op'>=</span> <span class='fl'>5</span>,
  eps_neg_beta <span class='op'>=</span> <span class='fl'>95</span>,
  max_eps_pos <span class='op'>=</span> <span class='fl'>0.5</span>,
  max_eps_neg <span class='op'>=</span> <span class='fl'>0.5</span>,
  mean_coi_prior_shape <span class='op'>=</span> <span class='fl'>1.5</span>,
  mean_coi_prior_scale <span class='op'>=</span> <span class='fl'>0.5</span>,
  mean_coi_var <span class='op'>=</span> <span class='fl'>1</span>,
  allele_freq_var <span class='op'>=</span> <span class='fl'>0.1</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>Data to be used in MCMC, expected input is a list
of lists of numeric vectors, where each list element is a
collection of observations across samples at a single genetic locus.</p></td>
    </tr>
    <tr>
      <th>sample_ids</th>
      <td><p>Vector containing the ordered unique identifier for samples</p></td>
    </tr>
    <tr>
      <th>loci</th>
      <td><p>Vector containing the ordered unique identifer for loci</p></td>
    </tr>
    <tr>
      <th>is_missing</th>
      <td><p>Boolean matrix indicating whether the observation
should be treated as missing data and ignored. Number of rows equals the
number of loci, number of columns equals the number samples. Alternatively,
the user may pass in FALSE if no data should be considered missing.</p></td>
    </tr>
    <tr>
      <th>thin</th>
      <td><p>Positive Integer. How often to sample from mcmc,
1 means do not thin</p></td>
    </tr>
    <tr>
      <th>burnin</th>
      <td><p>Positive Integer. Number of MCMC samples to
discard as burnin</p></td>
    </tr>
    <tr>
      <th>samples</th>
      <td><p>Positive Integer. Number of samples to take
after burnin</p></td>
    </tr>
    <tr>
      <th>complexity_limit</th>
      <td><p>Limit on the total number of computations before
resorting to an importance sampling based approach of the integral. Total
number of computations is approximately</p></td>
    </tr>
    <tr>
      <th>importance_sampling_depth</th>
      <td><p>Positive Integer. Min number
of samples to take during importance sampling. Larger values
result in longer computation time, too small of values will
result in poor mixing.</p></td>
    </tr>
    <tr>
      <th>importance_sampling_scaling_factor</th>
      <td><p>Positive Ingeter.
Total additional importance samples taken per increase in
complexity of infection. Total number of
samples = importance_sampling_depth + coi * importance_sampling_scaling_
factor</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Logical indicating if progress is printed</p></td>
    </tr>
    <tr>
      <th>eps_pos_0</th>
      <td><p>0-1 Numeric. Initial eps_pos value</p></td>
    </tr>
    <tr>
      <th>eps_pos_var</th>
      <td><p>0-1 Numeric. Variance used in sampling eps_pos</p></td>
    </tr>
    <tr>
      <th>eps_pos_alpha</th>
      <td><p>Positive Numeric. Alpha parameter in
Beta distribution for eps_pos prior</p></td>
    </tr>
    <tr>
      <th>eps_pos_beta</th>
      <td><p>Positive Numeric. Beta parameter in
Beta distribution for eps_pos prior</p></td>
    </tr>
    <tr>
      <th>eps_neg_0</th>
      <td><p>0-1 Numeric. Initial eps_neg value</p></td>
    </tr>
    <tr>
      <th>eps_neg_var</th>
      <td><p>0-1 Numeric. Variance used in sampling eps_neg</p></td>
    </tr>
    <tr>
      <th>eps_neg_alpha</th>
      <td><p>Positive Numeric. Alpha parameter in
Beta distribution for eps_neg prior</p></td>
    </tr>
    <tr>
      <th>eps_neg_beta</th>
      <td><p>Positive Numeric. Beta parameter in
Beta distribution for eps_neg prior</p></td>
    </tr>
    <tr>
      <th>max_eps_pos</th>
      <td><p>0-1 Numeric. Maximum allowed value for eps_pos</p></td>
    </tr>
    <tr>
      <th>max_eps_neg</th>
      <td><p>0-1 Numeric. Maximum allowed value for eps_neg</p></td>
    </tr>
    <tr>
      <th>mean_coi_prior_shape</th>
      <td><p>Positive Numeric. Shape parameter for gamma
prior on mean complexity of infection.</p></td>
    </tr>
    <tr>
      <th>mean_coi_prior_scale</th>
      <td><p>Positive Numeric. Scale parameter for gamma
prior on mean complexity of infection.</p></td>
    </tr>
    <tr>
      <th>mean_coi_var</th>
      <td><p>Positive Numeric. Variance used in sampling mean_coi</p></td>
    </tr>
    <tr>
      <th>allele_freq_var</th>
      <td><p>Positive Numeric. Variance used in sampling allele
frequencies</p></td>
    </tr>
    </table>


  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Maxwell Murphy.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


